@model Minesweeper.Models.GameBoardModel

@*
    This partial view loads a new minesweeper game board.
*@

<h6>Game loaded at: @DateTime.Now</h6>

<div class="game-board" id="gameBoardContainer">

    @* create the rows and columns to use for the gameboard *@
    @for (int row = 0; row < @Model.Size; row++)
    {
        for (int col = 0; col < @Model.Size; col++)
        {
            <form method="post" asp-controller="Game" asp-action="HandleClick">
                <input type="hidden" name="row" value="@row" />
                <input type="hidden" name="col" value="@col" />
                @* if the button has been clicked active will be false so this will change the button look *@
                <button class="game-button" type="submit">

                    @* Label for the buttons when they have been click the live neightbors will show. *@
                    <div class="button-label">
                    </div>
                </button>
            </form>
        }
    }
</div>

<form asp-action="SaveGame" method="post">
    @* @Html.Serialize("gameBoard", Model) *@
    <input type="hidden" name="Size" value="@Model.Size" />
    <input type="hidden" name="BombRatio" value="@Model.BombRatio" />
    <input type="hidden" name="TotalCells" value="@Model.TotalCells" />
    <input type="hidden" name="LiveCells" value="@Model.LiveCells" />
    <input type="hidden" name="NonLiveCells" value="@Model.NonLiveCells" />
    <input type="hidden" name="FirstClick" value="@Model.FirstClick" />

    @* Individual hidden fields for each property in the Grid array *@
    @for (int row = 0; row < Model.Size; row++)
    {
        for (int col = 0; col < Model.Size; col++)
        {
            <input type="hidden" name="Grid[@row][@col].Row" value="@Model.Grid[row, col].Row" />
            <input type="hidden" name="Grid[@row][@col].Column" value="@Model.Grid[row, col].Column" />
            <input type="hidden" name="Grid[@row][@col].Visited" value="@Model.Grid[row, col].Visited" />
            <input type="hidden" name="Grid[@row][@col].Live" value="@Model.Grid[row, col].Live" />
            <input type="hidden" name="Grid[@row][@col].LiveNeighbors" value="@Model.Grid[row, col].LiveNeighbors" />
            <input type="hidden" name="Grid[@row][@col].Flagged" value="@Model.Grid[row, col].Flagged" />
        }
    }
 
    <div>
        <button class="btn btn-info save-game-btn" type="submit">SAVE</button>
        <button class="btn btn-danger quit-game-btn">QUIT</button>
    </div>
</form>